<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>audio</title>

</head>

<body>
    <!-- 音乐 start-->
    <div class="musicinfo" id="musicinfo">
        <audio id="musicid" src="src/msg.mp3" preload="preload">您的浏览器不支持 audio标签。</audio>
    </div>
    <!-- 音乐 end-->
    <script type="text/javascript">
        // 音乐播放
        /*function autoPlayMusic() {
            // 自动播放音乐效果，解决浏览器或者APP自动播放问题
            function musicInBrowserHandler() {
                musicPlay(true);
                document.body.removeEventListener('touchstart', musicInBrowserHandler);
            }
            document.body.addEventListener('touchstart', musicInBrowserHandler);

            // 自动播放音乐效果，解决微信自动播放问题
            function musicInWeixinHandler() {
                musicPlay(true);
                document.addEventListener("WeixinJSBridgeReady", function () {
                    musicPlay(true);
                }, false);
                document.removeEventListener('DOMContentLoaded', musicInWeixinHandler);
            }
            document.addEventListener('DOMContentLoaded', musicInWeixinHandler);
        }
        function musicPlay(isPlay) {
            var audio = document.getElementById('musicid');
            if (isPlay && audio.paused) {
                audio.play();
            }
            if (!isPlay && !audio.paused) {
                audio.pause();
            }
        }
        // musicPlay(true);
        autoPlayMusic()*/
    </script>
    <script>
        // document.addEventListener('DOMContentLoaded', function(){
        //     function audioAutoPlay(){
                var audio = document.getElementById('musicid');
        //         audio.play();
        //         document.addEventListener('WeixinJsBridgeReady',function(){
        //             audio.play();
        //         }, false)
        //     }
        //     audioAutoPlay();
        // }, false)
        function musicInWeixinHandler() {
            // 一般浏览器
            audio.play();
            document.addEventListener("WeixinJSBridgeReady", function () {
                // 微信浏览器
                 audio.load();
            }, false);
            document.removeEventListener('DOMContentLoaded', musicInWeixinHandler);
        }
        document.addEventListener('DOMContentLoaded', musicInWeixinHandler);
        setTimeout(function(){
            audio.play();
        }, 2000);
    </script>
</body>

</html>
